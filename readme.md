# MDGenerator - 智能Markdown编辑器

> [English Version (英文版本)](./readme_en.md)

## 功能简介

**MDGenerator** 是一款全开源的极简Markdown编辑器，支持全部的MD标准语法，以及常见的MD扩展语法，如视频、HTML元素等。我们试图以最小的环境对MD文件的离线编写、AI辅助创作、在线发布等功能提供支持，以减轻网络文档编写的工作负担。

![](./image/mdfileloader.png)

## 核心特色功能

### 基础编辑功能
1. **双栏编辑模式** - 提供实时的Markdown文件编辑预览
2. **剪切板图像自动固化** - 可以直接通过快捷键Ctrl+V添加到文档中，并自动生成本地文件
3. **文件拖拽支持** - 支持拖拽打开Markdown文件
4. **自定义界面** - 支持自由调节菜单栏、编辑栏字体大小和缩放比例

### AI辅助写作功能 ⭐ (V0.9新增)
5. **AI文字优化** (Ctrl+↑) - 智能润色和优化选中的文本，提升文章质量
6. **AI智能查错** (Ctrl+←) - 自动检查语法、拼写、逻辑错误，提供修改建议
7. **AI智能续写** (Ctrl+↓) - 根据上下文智能续写内容，保持语言风格一致
8. **AI自定义编辑** (Ctrl+→) - 根据您的自定义指令对文本进行编辑
9. **AI智能搜图** (Ctrl+Alt+F) - AI辅助搜索相关图片，快速配图

> **支持多种AI模型**：兼容OpenAI API标准接口，支持ChatGLM、DeepSeek、OpenAI等多种AI服务

### WordPress集成功能 (V0.8新增)
10. **一键发布文章** - 将Markdown文章自动转换并上传到WordPress
11. **自动图片上传** - 文章中的图片自动上传到WordPress媒体库并替换链接
12. **完整元数据支持** - 支持文章分类、标签、特色图片等设置

### 图片管理功能
13. **桌面截图** (Ctrl+Alt+V) - 支持桌面截图并自动插入文档，可自定义缩放比例
14. **图片链接切换** - 本地图片与网络图片链接一键切换

MDGenerator 采用MIT协议进行发布，源码完全公开，欢迎您使用或进行二次开发。

## 版本信息

### V0.9 (当前版本) - 2026年1月
**AI辅助写作全面升级**
1. ✨ 增加AI辅助写作功能
   - AI文字优化（Ctrl+↑）
   - AI查错校对（Ctrl+←）
   - AI智能续写（Ctrl+↓）
   - AI自定义编辑（Ctrl+→）
2. 🖼️ 增加AI智能搜图功能（Ctrl+Alt+F）
3. 📸 增加桌面截图功能（Ctrl+Alt+V），支持自定义缩放比例
4. 🎯 新增一系列辅助写作的右键菜单功能
5. 🔧 支持OpenAI兼容的多种AI模型接口

### V0.81
- 修正了当没有图片时上传文章失败的问题

### V0.8 - WordPress集成
**主要功能更新**
1. 删除了FTP上传功能，改为WordPress上传功能
2. 增加了上传文章到WordPress服务器的功能
3. 增加了自由调节菜单栏编辑栏字体大小的功能
4. 修正了文字放大缩小后布局错乱的问题

### V0.6 - 稳定性提升
**一次主要版本升级**
1. 修正无法打开超链的问题
2. 优化解决间歇性文件无法显示，且刷新无效的问题
3. 支持了文件拖拽打开
4. Win11环境下运行初步测试通过
5. 发行版增加了Loader，便于在线升级
6. 重整了代码次序增加可读性，完善了文档

### V0.44
- 改变目标注册表树，使IE版本设置的注册表操作不再需要管理员权限

### V0.43
- 新增退出时检查文件是否保存的功能

### V0.41
- 修改底层MD生成器源码，为图片添加随机尾缀，修正了图片出现X问题，但CPU占用率有所提高

### V0.4
- 增加了MD语法简介，并设置为启动默认显示

### V0.33
- 修正了Win10缩放比例为150%时程序抛出异常的错误

### V0.32b - 首个公开测试版
- 第一个正式发布的测试版，支持Win7、Win10、64位环境下测试

## 快速开始

### 安装配置

1. **下载安装**
   - 下载最新版本的MDGenerator
   - 解压到任意目录
   - 运行 `MDGenerator.exe`

2. **配置AI功能**（可选）
   - 打开 `设置` → `系统设置`
   - 配置AI API Key和API地址
   - 支持以下AI服务：
     - ChatGLM (默认)
     - DeepSeek
     - OpenAI
     - 其他OpenAI兼容接口

3. **配置WordPress**（可选）
   - 打开 `设置` → `系统设置`
   - 输入WordPress站点地址
   - 输入用户名和应用密码
   - 应用密码获取方法：WordPress后台 → 用户 → 个人资料 → 应用密码

### 使用指南

#### 基础编辑
- **新建文件**：文件 → 新建 (Ctrl+N)
- **打开文件**：文件 → 打开 (Ctrl+O)，或直接拖拽MD文件到窗口
- **保存文件**：文件 → 保存 (Ctrl+S)
- **粘贴图片**：直接在编辑区按 Ctrl+V 粘贴剪切板图片

#### AI辅助写作
1. **文字优化**
   - 选中需要优化的文本
   - 按 `Ctrl+↑` 或右键菜单选择"AI文字优化"
   - AI将对文本进行润色和优化

2. **智能查错**
   - 选中需要校对的文本
   - 按 `Ctrl+←` 或右键菜单选择"AI查错"
   - 查看AI提供的错误和建议列表
   - 逐项查看并应用修改

3. **智能续写**
   - 将光标放在需要续写的位置
   - 按 `Ctrl+↓` 或右键菜单选择"AI续写"
   - AI将根据上下文自动续写内容

4. **自定义编辑**
   - 选中需要编辑的文本
   - 按 `Ctrl+→` 或右键菜单选择"AI自定义编辑"
   - 输入您的编辑要求（如"改为正式语气"、"翻译成英文"等）
   - AI将按您的要求编辑文本

5. **AI搜图**
   - 按 `Ctrl+Alt+F` 或右键菜单选择"AI搜图"
   - 输入图片关键词
   - 选择合适的图片自动插入文档

#### WordPress发布
1. 点击工具栏的"上传到WordPress"按钮
2. 设置文章标题、分类、标签
3. 选择特色图片（可选）
4. 点击"发布"
5. 文章和图片将自动上传到WordPress

#### 截图功能
- 按 `Ctrl+Alt+V` 开始截图
- 选择截图区域
- 截图将自动保存并插入到文档中
- 可在设置中调整截图缩放比例

## 系统要求

- **操作系统**：Windows 7 / 8 / 10 / 11
- **.NET Framework**：4.5 或更高版本
- **网络连接**：使用AI功能和WordPress发布功能时需要
- **屏幕分辨率**：建议 1920x1080 或更高


## 技术架构

### 核心原理
EditorMD是一款非常便捷的基于HTML+JS的Markdown编辑器框架，我们通过Windows内置的WebBrowser对其进行包裹和自动化控制，将这个编辑器框架进行了平台化封装。

### 实现步骤

1. **浏览器环境定制**
   - 根据WebBrowser的最小运行环境需求对.NET平台内置的IE浏览器进行深度定制
   - 同时兼容Windows 7、Windows 10和Windows 11

2. **双向数据交换**
   - 通过在JS层和C#层分别编写适配代码
   - 完成C#代码与EditorMD的基本数据交换
   - 实现本程序代码对Web框架的遥控

3. **功能适配封装**
   - 编写适配器，对需要与EditorMD进行交互的功能进行包裹
   - 如提取图片信息、交换图片链接地址、代码区和预览区的数据同步等

4. **WordPress集成**
   - 通过WordPress REST API将文章和图片自动上传WordPress服务器
   - 支持完整的文章元数据管理

5. **AI能力集成**
   - 集成OpenAI兼容的AI Agent接口
   - 提供智能写作辅助功能
   - 支持流式响应和上下文管理

### 项目结构
```
MDGenerator/
├── Program/MDGenerator/
│   ├── MainForm/          # 主窗体和UI
│   ├── Markdown/          # Markdown适配器
│   ├── WordPress/         # WordPress集成模块
│   ├── AIForms/          # AI辅助写作模块
│   ├── Tool/             # 工具类和配置
│   └── Properties/       # 项目属性
├── bin_Release/          # 发布版本
└── editormd/            # EditorMD框架
```

详细的设计文档请参考[《MDGenerator设计文档》](./design.md "《MDGenerator设计文档》")



### 开发环境
- Visual Studio 2019 或更高版本
- .NET Framework 4.5+

## 许可证

本项目采用 **MIT License** 开源协议。

您可以自由的使用、编辑、分发本软件。

## Contributor

Fantasy，AndyVane，梦程


---

**享受智能写作，让AI助力您的创作！** ✨




